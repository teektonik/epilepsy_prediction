# Предсказание эпилептических приступов


> ## Термины и пояснения
> - EDA - электродермальная активность,  относится к изменению электропроводности кожи в ответ на выделение пота. EDA связан с регулированием нашей внутренней температуры и с эмоциональным возбуждением.
> - BVP - пульсовой объем крови. Количество крови, протекающей через данный отрезок артерии в течение каждого пульсового периода.
> - HRV - вариабельность сердечного ритма. Это показатель, который отражает неравномерность сердцебиения человека.
> - акселерометр - прибор для измерения ускорения, который работает как датчик изменения положения устройства в пространстве.
> - SQI - оценка качества сигнала, отображающий качество принимаемого сигнала в коэффициенте от 0 до 100, где 0 – очень плохое качество сигнала, тоесть сигнал практически отсутствует и 100 – максимально качественный сигнал.




## 1. Цели и предпосылки
### 1.1. Зачем идем в разработку продукта? 

- Разработка этого продукта поможет не только людям, страдающим эпилепсией, но и их близким и окружающим. 
- Успехом разработки будем считать, если точность предсказания будет достигать 90% процентов. (+-)
- Нашим продуктом могут пользоваться (органы здравоохранения???? эпилептики??? в целом все, кому надо??)

### 1.2. Предпосылки решения

В повседневной жизни больной нуждается в наблюдении и подвергается риску быть застигнутым врасплох приступом. 
Исходя из этих соображений появляется необходимость продукта, способного предсказать приступ и позволить вовремя принять необходимые лекарства, блокирующие приступ.

## 2. Методология    

### 2.1. Постановка задачи 

Наша цель заключается в разработке ML-системы, которая сможет уведомлять о приступе заблаговременно до его начала. Если человек, склонный к эпилепсии, будет пользоваться нашим продуктом, это значительно улучшит качество его жизни и обеспечит безопасность. 

Трудность задачи в выявлении аномалий. Пульс человека значительно ускоряется во время физической активности или эмоционального возбуждения. Нам необходимо научить модель не реагировать в подобных ситуациях, но в то же время не пропускать приближение эпилептического припадка.

### 2.2 Блок-схема решения

### 2.3 Этапы решения задачи
> Этапы:
> - Этап 1 - получение датасета
> - Этап 2 - подготовка данных
> - Этап 3 - подготовка прогнозных моделей
> - Этап 4 - интерпретация моделей

*Этап 1*
  
| Название данных  | Есть ли данные в компании (если да, название источника/витрин) | Требуемый ресурс для получения данных | Проверено ли качество данных|
| ------------- | ------------- | ------------- | ------------- |
| Seizure Gauge data | Dr Levin Kuhlman|  | + |

*Этап 2*

- __Препроцессинг__. В датасете нам даны пациенты и записи их сигналов: акселерометр, BVP, EDA. Эти сигналы мы объединяем в один, потом сегментируем их так, чтобы индексы сегментов совпадали началом и концом по времени. Эти сегменты мы сохраняем в папку new_data. Также создаём файл labels.csv, чтобы хранить в нём лейблы этих сегментам.

- __Нормализация__. Сегменты мы аугментируем, чтобы уменьшить дисбаланс классов. Для этого мы добавляем шум к сегментам, где есть эпилепсия, и сохраняем в папку normalized_data. Добавляем соответствующие лейблы в папку label_csv. Далее балансируем классы, избавляясь от сегментов, где нет эпилепсии, чтобы количество сегментов одного класса совпадало с количеством сегментов другого класса.

- __Подача в модель__. На этом этапе мы конкатенируем матрицу сигналов так, чтобы каждый столбец являлся одним сигналом. К получившейся матрице мы добавляем спектры этих сигналов в таком же виде: столбец - спектр, и в конец добавляем время. Наконец, эти матрицы мы подаём в модель для обучения.

*Этап 3*

На данный момент идёт обучение LSTM, 
